---
title: Мультисерверы
createTime: 2025/02/24 16:08:34
permalink: /ru/notes/doc/owner/other/multi-server/
---

::: info
Эта страница была переведена с помощью GitHub Copilot и может содержать грамматические ошибки или неловкие формулировки.
Если вы хотите помочь улучшить перевод, пожалуйста, обратитесь к [Language](/ru/notes/doc/owner/config-ref/languages/).
:::

::: warning
1. Эта функция все еще находится на экспериментальной стадии;
2. Пожалуйста, используйте эту функцию только если вы способны справиться с потенциальными проблемами;
3. Регулярно делайте резервные копии вашей базы данных, чтобы предотвратить потерю данных;
:::

## Введение

Настроив групповые серверы, вы можете подключить несколько серверов к одной базе данных, ��то позволит использовать
межсерверную телепортацию, межсерверное управление территориями и другие функции.

## Предварительные условия

- Понимание [структуры конфигурационных файлов Dominion](/ru/notes/doc/owner/config-ref/overview/) и завершение
  базовой конфигурации;
- Ваш сервер является групповым сервером и настроен с использованием BungeeCord или Velocity;
- Подготовьте базу данных MySQL или PgSql;

## Метод конфигурации

Основываясь на возникших до сих пор проблемах, есть три возможных сценария:

1. Обновление с более низкой версии до 4, уже используется (данные уже сгенерированы);
2. Только что установлен Dominion и еще не используется (данные не сгенерированы);

### Сценарий первый

Если вы ранее использовали SqLite, вам нужно сначала экспортировать базу данных с помощью `/dom export db`, затем настроить
новую базу данных MySQL или PgSql и запустить сервер один раз,
импортировать базу данных с помощью `/dom import db`.
Затем остановите сервер и продолжите настройку согласно [Сценарию второму](#Scenario-Two).

Если ваша предыдущая база данных была MySQL или PgSql, вы можете напрямую обратиться к [Сценарию второму](#Scenario-Two) для настройки
и добавления других подсерверов.

::: warning
`server-id` в этом конфигурационном файле сервера не может быть изменен!

Поскольку территории в текущей базе данных все установлены на этот `server-id`, его изменение приведет к тому, что исходные
данные станут недоступными.
:::

::: info
Если у вас ранее было несколько подсерверов, каждый со своими данными о территориях, к сожалению, в настоящее время у нас нет
безопасного способа объединить данные с нескольких подсерверов в одну базу данных.
Вы можете выбрать только сохранение данных о территориях с одного из серверов.
:::

### Сценарий второй

#### 1. Настройка базы данных

Сначала настройте базу данных. Вы можете выбрать использование MySQL или PgSql, затем настройте ту же информацию о базе данных
в файле `plugins/Dominion/config.yml` всех подсерверов, чтобы подключить все серверы к одной базе данных.

::: warning
Не запускайте сервер сразу после настройки!
:::

#### 2. Настройка информации о сервере

Затем настройте информацию о сервере в файле `plugins/Dominion/config.yml` каждого подсерверa:

```yaml
multi-server:
  enable: true
  server-name: server
  server-id: 1
```

Среди них:

- `multi-server.enable`: Установите значение `true`, чтобы включить функцию группового сервера;
- `multi-server.server-name`: Имя сервера, которое должно совпадать с именем сервера в BungeeCord или Velocity;
- `multi-server.server-id`: Идентификатор сервера, используемый Dominion для различения разных серверов. **Это значение должно быть положительным целым числом и уникальным для всех серверов**;

#### 3. Запуск сервера

Наконец, убедитесь, что все серверы настроили информацию о базе данных и информацию о сервере, затем запустите все серверы.

